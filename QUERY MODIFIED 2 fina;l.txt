SELECT * FROM Orders$
---•	What is the year of the earliest order?
SELECT
   YEAR(MIN('Order Date')) AS EarliestOrderYear
FROM Orders;
-----•	What are the total sales for each quarter of 2018? 2018 AS 2014
SELECT
     QUARTER,(''Order Date') AS Quarter,
    SUM(Sales) AS TotalSales
FROM Orders
WHERE YEAR('Order Date') = 2014
GROUP BY QUARTER ('Order Date')
ORDER BY  Quarter;
	----•	How many orders were placed on the first day of each month in 2017?
SELECT
    MONTH ('Order Date') AS Month,
    COUNT(*) AS NumberOfOrders
FROM  Orders
WHERE YEAR('Order Date') = 2017 
 AND DAY('Order Date') = 1
GROUP BY MONTH('Order Date')
ORDER BY Month;
	-----•	What is the difference in days between the earliest and latest order dates?
SELECT 
    DATEDIFF(MAX('Order Date'),MIN('Order Date')) AS Date_diffrence
FROM Orders;
	----•	What is the average order value for each day of the week?
SELECT 
    DAYOFWEEK('Order Date') AS DayOfWeek,
    AVG('Value']) AS AverageOrderValue
FROM Orders 
GROUP BY DAYOFWEEK('Order Date')
ORDER BY  DAYOFWEEK;
	-------•	What are the total sales for orders placed in the month of July across all years?
SELECT 
     YEAR('Order Date') As YEAR,
     SUM('Sales') AS TotalSales
FROM  Orders
WHERE MONTH('Order Date') = 7
GROUP BY YEAR('Order Date')
ORDER BY YEAR;
	--------•	Which month had the highest total sales in 2019? 2017
SELECT 
    MONTH('Order Date') AS Month,
   SUM('Sales') AS TotalSales
FROM  Orders
WHERE  YEAR('Order Date') = 2017 
GROUP BY  MONTH('Order Date')
ORDER BY  Totalsales DESC
	----------------------•	How many orders were placed on weekends (Saturday and Sunday) in 2018?   2014
SELECT 
     COUNT('Order ID') AS NumberOfWeekendOrders
FROM Orders
WHERE YEAR('Order Date') = 2014
AND MONTH ('Order Date') IN (1, 7);
	---------------•	What is the average order value for each quarter?
SELECT 
    QUARTER,('Order Date') AS Quarter,
    AVG('Sales') AS AverageOrderValue
FROM  Orders
GROUP BY QUARTER ('Order Date')
ORDER BY Quater;
------------------•	What is the earliest order date for each year?
SELECT 
    YEAR('Order Date') AS Year,
    MIN('Order Date') AS EarliestOrderDate
FROM  Orders
GROUP BY YEAR('Order Date')
ORDER BY Year;
   ----customer wise total sale ,the total sale should be greater than average
WITH CustomerSalesAs(
     SELECT
          CustomerID,
          SUM(Unitprice*Quantity) AS TotalSales
        FROM OrderDeatails
        JOIN order ON orderDetails.OrderID=Orders.OrderID
        GROUP BY CustmoreID
)
SELECT
     CUSTOMER ID,
     TOtalsales
 FROM CustomerSales
WHERE Totalsales > (SELECT AVG(TOtalSales) FROM CustomerSales);

-----Identify the employes who have the proces more than 50 orders
WITH EmployeeOrderCount AS ( 
SELECT 
    EmployeeID,
    COUNT(OrderID) AS OrderCount
  FROM Orders
    GROUP BY EmployeeID
)
SELECT
    EmployeeID, 
    OrderCount
FROM EmployeeOrderCount
 WHERE OrderCount > 50;

---Find customers who placed orders in more than 10 unique months	 
WITH CustomerOrderMonths AS (
SELECT
    CustomerID,
    COUNT(DISTINCT DATE_FORMAT(OrderDate,'%Y%m')) AS UniqueMonths
    FROM Orders
    GROUP BY CustomerID
)
SELECT
    CustomerID,
    UniqueMonths
FROM CustomerOrderMonths
WHERE UniqueMonths > 10;

-----identify the top 5 products genarating the higest toteals sales revenu
WITH ProductRevenue AS
 SELECT  
    P.ProductID,
    P.ProductNme,
     SUM(OD.UnitPrice * Quantity) AS TotalRevenue
 FROM Products P
 JOIN 'Orde Details' OD ON P.ProductID =OD.ProductID
 GROUP BY P.ProductID, P.ProductName
)
SELECT
    ProductID,
   ProductName,
   TotalRevenue
FROM  ProductRevenue
ORDER BY  TotalRevenue DESC
OFFSET 0 ROWS FETCH NEXT 5 ROWS ONLY;

------list orders that ware placed and shiped with in the same month
WITH OrdersSameMonth AS (
    SELECT 
       OrderID,
       CustomerID,
       OrderDate, 
       ShippedDate
    FROM Orders
    WHERE DATE_FORMAT( OrderDate, '%Y%m') = DATE_FORMAT(ShippedDate,'%Y%m' )
      AND ShippedDate IS NOT NULL
)
SELECT 
    OrderID,
    CustomerID,
    OrderDate, 
   ShippedDate
FROM OrderSameMonth;
 
	

